\chapter{Введение}

\definition

\definitionfont{Организованные системы} --- системы, в которых решения принимаются <<сознательно>>. Примеры таких систем: люди, промышленные предприятия, магазины.

\bigskip

\noindent Примеры задач:
\begin{itemize}[nosep]
	\item Где построить магазин, чтобы получать наибольшую прибыль?
	
	\item Сколько производить деталей на заводе, чтобы отношение между доходом и выручкой было наибольшим?
\end{itemize}

\bigskip

\noindent\fbox{
	\parbox{\linewidth}{
		Примерно до второй мировой войны все сложные решения принимались лишь на основе опыта и здравого смысла. Однако позже появились сложные системы, в которых опыта и здравого смысла оказалось недостаточно.
		
		Тогда же появилась \textbf{идея} рассматривать числовые характеристики систем для принятия решения, при этом должны использоваться \definitionfont{математические модели} --- упрощённые, но адекватные описания реальной жизни.
	}
}

\section{Построение математических моделей}

\noindent
\fbox{
	\parbox{\linewidth}{
		Математические модели строятся на основании \definitionfont{исходных данных} --- конкретных проблем в конкретных жизненных ситуациях.
	}
}

\bigskip

\textbf{Примерный алгоритм построения математических моделей}

\begin{enumerate}[nosep]
	\item Нужно понять, \textit{что будем оптимизировать?} По каким критериям будет оценивать решения? Например, если нас спрашивают, где построить магазин, то нам нужно понять, как выбрать для этого место. Нужно, чтобы была максимальная прибыль или чтобы наибольшая удалённость от конкурентов? Если мы закупаем детали для предприятия, то нужно узнать, хочется ли нам наибольшую прибыль или же минимальные издержки. А может нам важно количество произведённой продукции?
	
	\item Нужно понять, \textit{какие характеристики существенно влияют на оптимизируемую характеристику}? Например, если наша оптимизируемая характеристика --- это прибыль предприятия, то нужно определить, из чего складываются выручка и затраты.
	
	\item \textit{Формулировка задачи} с точным указанием всех характеристик. Каждая из характеристик должна относиться либо к \definitionfont{переменным}, либо к \definitionfont{параметрам}. Первые могут меняться (обозначаются они через $x, y, z, \dots$), а вторые --- это константы (обозначаются они через $a, b, c, \dots$). Например, переменные --- это выручка и затраты предприятия, а параметры --- это площадь помещения, количество станков, количество работников.
	
	\item Выбор всех обозначений и математическая запись с учётом ограничений и требований для переменных.
	
	\item Понимание, что изначальная проблема состоит в другом, не учтены такие-то параметры, значит нужно вернуться к самому началу...
\end{enumerate}

\example

Ваш друг плывёт на лодке, ему нужно попасть в определённую точку на берегу, и он спрашивает вас, куда ему нужно причалить.

\begin{center}
	\begin{tikzpicture}
		\draw[black, very thick] (-1, -1) -- (4.5, 2.3);
		\draw[gray, dashed] (4.5, -1.1) -- (3, 1.4);
		\filldraw[black] (0.5, -0.1) circle (2pt) node[anchor=south]{A};
		\filldraw[black] (3, 1.4) circle (2pt) node[anchor=south]{B};
		\filldraw[black] (2, 0.8) circle (2pt) node[anchor=south]{O};
		\filldraw[black] (4.5, -1.1) circle (2pt) node[anchor=west]{C};
		\draw [-{Stealth[length=2.5mm]}] (2, -0.5) -- node[above=1mm] {\text{Лодка\quad\;}} (4.2, -1.1);
		\draw [-{Stealth[length=2.5mm]}] (-2, -3.5) -- node[above=1mm] {\text{Берег\quad\;}} (0, -0.7);
		\draw [|<->|] (1.60294, 1.46176) -- node[above=1mm] {$x$} (2.60294, 2.06176);
		\draw [|<->|] (2.16176, 2.79706) -- node[above=1mm] {$15$} (-0.33824, 1.29706);
		\draw [|<->|] (5.42647, -0.54412) -- node[above=1mm] {$9$} (3.92647, 1.95588);
	\end{tikzpicture}
\end{center}

\textbf{Характеристики рассматриваемой системы}
\begin{itemize}[nosep]
	\item $C$ --- текущее местоположение лодки;
	
	\item $A$ --- точка, в которую нужно попасть;
	
	\item $B$ --- ближайшая к лодке точка берега;
	
	\item $O$ --- точка причаливания;
	
	\item $AB$ = 15 км;
	
	\item $BC$ = 9 км (расстояние от лодки до берега);
	
	\item $v_{\text{по суше}} = 5$ км/ч;
	
	\item $v_{\text{лодки}} = 4$ км/ч;
		
	\item $OB = x$;
	
	\item течения воды нет, то есть скорость течения равна нулю;
	
	\item цвет лодки не существенен.
\end{itemize}

\bigskip

Будем оптимизировать время $t$
\begin{align*}
	t &= \underbrace{\frac{OC}{v_{\text{по воде}}}}_{\text{движение по воде}} + \underbrace{\frac{OA}{v_{\text{по суше}}}}_{\text{движение по суше}} \\
	&= \boxed{\frac{\sqrt{x^2+81}}{4} + \frac{15 - x}{5} \to \min_x}
\end{align*}

Установим \textbf{ограничение}
\[
	0 \le x \le 15,
\]

потому что иначе решение будет точно неоптимальным.

\bigskip

Решим задачу, найдя нули производной
\[\derivative{t}{x} = \frac{2x}{8\sqrt{x^2+81}} - \frac{1}{5} = 0,\]
\[\frac{x}{4\sqrt{x^2+81}} = \frac{1}{5},\]
\[\frac{x^2}{16(x^2 + 81)} = \frac{1}{25},\]
\[	25x^2 = 16x^2 + 16 \cdot 81,\]
\[9x^2 = 16 \cdot 81,\]
\[x^2 = 16 \cdot 9,\]
\[x_1 = -12, \qquad x_2 = 12.\]

Решение $x_1 = -12$ не подходит ввиду ограничения выше, а вот $\boxed{x = 12}$ является ответом (упражнение).

\section{Оптимизационные (экстремальные) задачи}

\definition[экстремальная задача]

\definitionfont{Экстремальная задача} формулируется следующим образом

\begin{enumerate}[nosep]
	\item Есть функция $f(x)$, значение которой нужно оптимизировать;
	
	\item Есть набор ограничений $g_1(x) \le b_1, g_2(x) \le b_2, \dots$;
	
	\item $x \in X$, $X$ --- \definitionfont{множество всех решений},
\end{enumerate}

при этом \definitionfont{нужно найти}
\[
	\min_{x \in X} f(x) \quad \text{или} \quad \max_{x \in X} f(x).
\]

\definition

\definitionfont{Допустимые решения} --- множество всех значений $x \in X$, которые удовлетворяют всем ограничения $\{g_i\}$.

\definition

Допустимое решение $x^*$ называется \definitionfont{оптимальным решением задачи}, если
\[
	\forall x \in X \qquad f(x^*) \ge f(x).	
\]

или то же самое
\[
	f(x^*) = \max_{x \in X} f(x).	
\]

\remark

Ограничения $\{g_i\}$ могут быть какими угодно.

\example

Пусть наши исходные данные это
\[f(x) = c_1 x_1 + c_2 x_2 \to \max_x,\]
\[g(x) = ax_1 + bx_2 \le d,\]
\[x_1 \ge 0, \quad x_2 \ge 0.\]

Нужно найти $x_1$ и $x_2$.

\definition

Будем говорить, что есть $\P$ --- \definitionfont{общая задача}, а $p \in \P$ --- конкретная задача, в которой $c_1, c_2, a, b, d$ --- это конкретные числа. То есть \definitionfont{общая задача} --- это множество конкретных задач.

\definition

\definitionfont{Длина входа задачи} --- это количество ячеек в памяти, которое занимает задача с допущением, что каждое число занимает в памяти ровно одну ячейку. Будем обозначать это $\abs{p}$.

\section{Алгоритмы}

\definition

\definitionfont{Элементарные операции} --- арифметические операции и операции сравнения.

\definition

\definitionfont{Трудоёмкость алгоритма} $A$ решения задачи $p \in \P$ --- это количество элементарных операций, используемых в этом алгоритме. Будем обозначать это $T_A(p)$.

\remark

Чем больше $\abs{p}$, тем больше $T_A(p)$, поэтому будем оценивать трудоёмкость так
\[
	T_A(p) \le f_A\big(\abs{p}\big).
\]

\definition

Если $f_A\big(\abs{p}\big) = C \cdot \abs{p}^k$, то такой алгоритм будем называть \definitionfont{<<хорошим>>} (\definitionfont{полиномиальным}).

Примерами задач, для которых существуют <<хорошие>> алгоритмы, являются математические задачи, в которых $x$ --- множество векторов (линейное и нелинейное программирование), и задачи комбинаторики (например, перестановки).

\definition[задача линейного программирования]

\[\sum_{j=1}^{n} c_j x_j \to \max_{(x_j)},\]
\[\sum_{j=1}^{n}a_{ij} x_j \le b_i, \quad i = 1\dots m,\]
\[x_j \in \{0, 1, 2, \dots\} \text{ или то же самое } x_j \ge 0, \quad j = 1\dots n.\]

\textbf{Распространённый частный случай}: $x_j \in \{0, 1\}$.

\section{Свойства оптимизационных задач}

\fact

\[
	\max_x f(x) = \max_x \Big(\big(-1\big) \cdot \big(-f(x)\big)\Big) = \underbrace{-\min_x \big(-f(x)\big)}_{\text{новая задача}}.
\]

\fact[оценка сверху, релаксированные задачи]

Если $X \subseteq X'$, то
\[
	\max_{x \in X} f(x) \le \max_{x \in X'} f(x).
\]

\definition

Пусть есть две общие задачи: $(\P) \max_{x \in X} f(x)$ и $(\Q) \max_{y \in Y} g(y)$. Будем говорить, что задача $\P$ \definitionfont{сводится к задаче} $\Q$, если
\[
	\forall p \in \P \quad \forall q \in \Q
\]

\begin{enumerate}[nosep]
	\item существует полиномиальный алгоритм $A_1$, который переводит входные данные задачи $p$ во входные данные задачи $q$;
	\[
		p \qquad \stackrel{A_1}{\longrightarrow} \qquad q
	\]
	
	\item существует полиномиальный алгоритм $A_2$, с помощью которого можно из оптимального решения $y^0$ задачи $q$ построить оптимальное решение $x^*$ задачи $p$.
	\[
		x^* \qquad \stackrel{A_2}{\longleftarrow} \qquad y^0
	\]
\end{enumerate}

\textit{Остаётся вопрос}: как понять, что построенное решение $x^*$ --- оптимальное?

\remark

Везде далее всегда будем оптимизировать именно $\max$, а не $\min$.

\fact[сведение к другой задаче]\label{fact:reduction_to_other_problem}

Пусть есть 2 задачи: $\P$ и $\Q$, при этом
\begin{enumerate}[nosep]
	\item $x^0$ --- допустимое решение задачи $\P$,
	
	\item $y^*$ --- оптимальное решение задачи $\Q$,
	
	\item $f(x^0) \ge g(y^*)$,
	
	\item $\forall x \in X \; \exists y \in Y \quad f(x) \le g(y)$,
\end{enumerate}

тогда $x^0$ --- оптимальное решение задачи $\P$.

\prooof

Пусть задача $\P$ имеет оптимальное решение $x^*$. По четвёртому пункту для $x^*$ существует некоторый $y^0$ такой, что 
\[
	f(x^*) \le g(y^0). \tag{*}
\]

По условию $y^*$ является оптимальным решением задачи $\Q$, значит верно следующее
\[
	g(y^*) \ge g(y^0). \tag{**}
\]

Составим цепочку неравенств

\[
	f(x^0) \stackrel{(3)}{\ge} g(y^*) \stackrel{(**)}{\ge} g(y^0) \stackrel{(*)}{\ge} f(x^*).
\]

Таким образом имеем неравенство
\[
	f(x^0) \ge f(x^*)
\]

хотя $x^*$ --- оптимальное решение задачи $\P$. Значит $x^0 = x^*$, то есть $x^0$ является оптимальным.

\example

$(\P)$
\[\sum_{j=1}^{n} c_j x_j \to \max_{(x_j)},\]
\[\sum_{j=1}^{n} a_j x_j \le b \tag{1},\]
\[x_1 + x_2 = d \tag{2},\]
\[x_j \ge 0, \quad j = 1\dots n. \tag{3}\]

Заметим, что $x_1$ можно выразить через $x_2$ (и наоборот). Рассмотрим другую задачу

$(\Q)$
\[c_1(d - y_2) + \sum_{j=2}^{n} c_j y_j \to \max_{(y_j)},\].
\[a_1 (d-y_2) + \sum_{j=2}^{n}a_j y_j \le b,\].
\[y_j \ge 0, \quad j = 1\dots n,\]
\[y_2 \le d.\]

Покажем, что задача $\P$ сводится к задаче $\Q$.

\prooof

Пусть $y^* = \begin{pmatrix} y^*_1 & \dots & y^*_n \end{pmatrix}$ --- это оптимальное решение задачи $\Q$. Будем строить решение $x^0$ задачи $\P$ следующим образом
\[
	x^0_j = \begin{cases}
		d - y_2,& j = 1 \\
		y_j,& j > 1
	\end{cases}
\]

то есть $x^0 = \begin{pmatrix} d - y_2 & y_2 & y_3 & \dots & y_n \end{pmatrix}$.

\begin{enumerate}[nosep]
	\item Покажем, что $x^0$ --- допустимое решение задачи $\P$. Для этого нужно показать, что оно удовлетворяет всем ограничениям. Заметим, что без условия $y_2 \le d$ значение $x_1$ может быть меньше нуля, а значит решение $x^0$ точно было бы не допустимым (ограничение 3).
	
	\begin{enumerate}
		\item Проверим ограничение 2
			\[
				x^0_1 + x^0_2 = d - y^*_2 + y^*_2 = d.
			\]
			
		\item Проверим ограничение 1
			\begin{align*}
				\sum_{j=1}^{n} a_j x^0_j =& \; a_1 x^0_1 + a_2 x^0_2 + \dots + a_n x^0_n \\
				=& \; a_1 (d - y^*_2) + a_2 y^*_2 + \dots + a_n y^*_n \\
				=& \; a_1 (d-y^*_2) + \sum_{j=2}^{n}a_j y^*_j \le b.
			\end{align*}
		
			Значит $x^0$ удовлетворяет всем ограничениям, а поэтому $x^0$ --- допустимое решение.	
	\end{enumerate}
	
	\item Мы показали, что $x^0$ --- допустимое решение задачи $\P$. Осталось показать, что оно оптимальное. Для этого будет использовать \ref{fact:reduction_to_other_problem}.
		
		\begin{enumerate}
			\item Выполнимость условия $f(x^0) \ge g(y^*)$ следует из того, что при подстановке, использованной при проверке ограничения 1, получится равенство
			\[
				f(x^0) = g(y^*).
			\]
			
			\item Выполнимость условия
			\[
				\forall x \in X \; \exists y \in Y \quad f(x) \le g(y)
			\]
			
			следует из того, что по любому $x = (x_j)$ можно построить $y = (y_j)$ следующим образом
			\[
				y_j = \begin{cases}
					d - x_2,& j = 1 \\
					x_j,& j > 1
				\end{cases}
			\]
		
			И вновь, если всё аккуратно подставить, то получится равенство
			\[
				f(x) = g(y).
			\]
		\end{enumerate}
\end{enumerate}

Таким образом мы доказали, что соблюдаются все условия для применения \cref{fact:reduction_to_other_problem}. Значит исходная задача $\P \mapsto \Q$.

Мы взяли задачу с $n$ переменными и перешли от неё к задаче с $n-1$ переменными. Разве не круто?!
